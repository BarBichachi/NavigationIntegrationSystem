<?xml version="1.0" encoding="utf-8" ?>
<Page x:Class="NavigationIntegrationSystem.UI.Pages.DevicesPage" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:local="using:NavigationIntegrationSystem.UI.Pages"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:vm="using:NavigationIntegrationSystem.UI.ViewModels.Devices" x:Name="RootPage" mc:Ignorable="d">

    <Grid Padding="16" RowDefinitions="Auto,*">
        <Grid Margin="0,0,0,12" ColumnDefinitions="*,Auto">
            <TextBlock FontSize="24" Text="Devices" />
            <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                <Button Command="{x:Bind ViewModel.SaveDevicesConfigCommand}" Content="Save" />
            </StackPanel>
        </Grid>

        <SplitView Grid.Row="1" DisplayMode="Overlay" IsPaneOpen="{x:Bind ViewModel.IsPaneOpen, Mode=TwoWay}" OpenPaneLength="520" PanePlacement="Right">
            <SplitView.Content>
                <ListView ItemsSource="{x:Bind ViewModel.Devices, Mode=OneWay}" SelectionMode="None">
                    <ListView.ItemTemplate>
                        <DataTemplate x:DataType="vm:DeviceCardViewModel">
                            <Border Margin="0,0,0,10" Padding="12" BorderThickness="1" CornerRadius="10">
                                <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto">
                                    <StackPanel Spacing="4">
                                        <TextBlock FontSize="18" Text="{x:Bind DisplayName}" />
                                        <TextBlock Opacity="0.7" Text="{x:Bind Type}" />
                                    </StackPanel>

                                    <StackPanel Grid.Column="1" HorizontalAlignment="Right" Spacing="6">
                                        <TextBlock HorizontalAlignment="Right" Text="{x:Bind Status}" />
                                    </StackPanel>

                                    <StackPanel Grid.Row="1" Grid.ColumnSpan="2" Margin="0,10,0,0" Orientation="Horizontal" Spacing="10">
                                        <Button Command="{x:Bind ToggleConnectCommand}">
                                            <TextBlock Text="{x:Bind IsConnected, Converter={StaticResource BoolToConnectTextConverter}}" />
                                        </Button>

                                        <CheckBox VerticalAlignment="Center" Content="Auto-Reconnect" IsChecked="{x:Bind AutoReconnect, Mode=TwoWay}" />

                                        <Button Command="{x:Bind OpenSettingsCommand}" Content="Settings" />
                                        <Button Command="{x:Bind OpenInspectCommand}" Content="Inspect" />
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </SplitView.Content>

            <SplitView.Pane>
                <Grid Padding="12" Background="{ThemeResource AcrylicInAppFillColorDefaultBrush}" RowDefinitions="Auto,*">
                    <Grid ColumnDefinitions="*,Auto">
                        <TextBlock FontSize="18" Text="{x:Bind ViewModel.SelectedDevice.DisplayName, Mode=OneWay}" />
                        <Button Grid.Column="1" Command="{x:Bind ViewModel.ClosePaneCommand}" Content="Close" />
                    </Grid>

                    <ContentControl Grid.Row="1" Margin="0,12,0,0">
                        <ContentControl.Content>
                            <Grid>
                                <Grid x:Name="SettingsPane" Visibility="{x:Bind ViewModel.PaneMode, Converter={StaticResource PaneModeToSettingsVisibilityConverter}}">
                                    <TextBlock Text="Settings pane (next step)" />
                                </Grid>

                                <Grid x:Name="InspectPane" Visibility="{x:Bind ViewModel.PaneMode, Converter={StaticResource PaneModeToInspectVisibilityConverter}}">
                                    <Grid RowDefinitions="Auto,*">
                                        <TextBlock Margin="0,0,0,8" Opacity="0.7" Text="Inspect (all fields)" />
                                        <ListView Grid.Row="1" ItemsSource="{x:Bind ViewModel.SelectedDevice.InspectFields, Mode=OneWay}">
                                            <ListView.ItemTemplate>
                                                <DataTemplate x:DataType="vm:InspectFieldViewModel">
                                                    <Grid Padding="0,4" ColumnDefinitions="220,*,70" ColumnSpacing="12">
                                                        <TextBlock Grid.Column="0" Text="{x:Bind Name}" />
                                                        <TextBlock Grid.Column="1" Text="{x:Bind ValueText}" TextTrimming="CharacterEllipsis" />
                                                        <TextBlock Grid.Column="2" HorizontalAlignment="Right" Opacity="0.7" Text="{x:Bind Unit}" />
                                                    </Grid>
                                                </DataTemplate>
                                            </ListView.ItemTemplate>
                                        </ListView>
                                    </Grid>
                                </Grid>
                            </Grid>
                        </ContentControl.Content>
                    </ContentControl>
                </Grid>
            </SplitView.Pane>
        </SplitView>
    </Grid>
</Page>
