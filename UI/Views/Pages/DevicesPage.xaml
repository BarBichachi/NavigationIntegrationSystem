<?xml version="1.0" encoding="utf-8" ?>
<Page x:Class="NavigationIntegrationSystem.UI.Views.Pages.DevicesPage" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:local="using:NavigationIntegrationSystem.UI.Views.Pages"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:panes="using:NavigationIntegrationSystem.UI.Views.Panes" xmlns:vm="using:NavigationIntegrationSystem.UI.ViewModels.Devices" x:Name="RootPage" mc:Ignorable="d">

    <Grid Padding="16" RowDefinitions="Auto,*">
        <Grid Margin="0,0,0,12" ColumnDefinitions="*,Auto">
            <TextBlock FontSize="28" FontWeight="SemiBold" Text="Devices" />
            <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                <Button Command="{x:Bind ViewModel.SaveDevicesConfigCommand}" Content="Save" Style="{ThemeResource AccentButtonStyle}" />
            </StackPanel>
        </Grid>

        <SplitView Grid.Row="1" DisplayMode="Overlay"
                   IsPaneOpen="{x:Bind ViewModel.IsPaneOpen, Mode=TwoWay}"
                   LightDismissOverlayMode="On" OpenPaneLength="520" PaneClosing="OnPaneClosing" PanePlacement="Right">
            <SplitView.Content>
                <ListView ItemsSource="{x:Bind ViewModel.Devices, Mode=OneWay}" SelectionMode="None">
                    <ListView.ItemContainerStyle>
                        <Style TargetType="ListViewItem">
                            <Setter Property="Padding" Value="0" />
                            <Setter Property="Margin" Value="0" />
                            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                        </Style>
                    </ListView.ItemContainerStyle>

                    <ListView.ItemTemplate>
                        <DataTemplate x:DataType="vm:DeviceCardViewModel">
                            <Border Margin="0,0,0,10" Padding="14"
                                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                    BorderThickness="1" CornerRadius="12">
                                <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto, Auto">
                                    <StackPanel Spacing="4">
                                        <TextBlock FontSize="18" Text="{x:Bind DisplayName}" />
                                        <TextBlock Opacity="0.7" Text="{x:Bind Type}" />
                                    </StackPanel>

                                    <TextBlock Grid.Column="1" HorizontalAlignment="Right" FontSize="12" FontWeight="SemiBold"
                                               Foreground="{x:Bind IsConnected, Mode=OneWay, Converter={StaticResource BoolToStatusForegroundBrushConverter}}"
                                               Text="{x:Bind Status, Mode=OneWay}" />

                                    <StackPanel Grid.Row="1" Grid.ColumnSpan="2" Margin="0,12,0,0" Orientation="Horizontal" Spacing="10">
                                        <Button Command="{x:Bind ToggleConnectCommand}">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <SymbolIcon Symbol="Remote" />
                                                <TextBlock Text="{x:Bind IsConnected, Mode=OneWay, Converter={StaticResource BoolToConnectTextConverter}}" />
                                            </StackPanel>
                                        </Button>

                                        <Button Command="{x:Bind OpenSettingsCommand}">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <SymbolIcon Symbol="Setting" />
                                                <TextBlock Text="Settings" />
                                            </StackPanel>
                                        </Button>

                                        <Button Command="{x:Bind OpenInspectCommand}">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <SymbolIcon Symbol="Preview" />
                                                <TextBlock Text="Inspect" />
                                            </StackPanel>
                                        </Button>
                                    </StackPanel>


                                    <StackPanel Grid.Row="2" Grid.ColumnSpan="2" Margin="0,8,0,0" VerticalAlignment="Center" Orientation="Horizontal"
                                                Spacing="8"
                                                Visibility="{x:Bind HasUnsavedSettings, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
                                        <FontIcon Margin="0,1,0,0" Glyph="&#xE7BA;" />
                                        <TextBlock Foreground="{ThemeResource SystemFillColorCautionBrush}" Text="Settings were changed but not saved" />
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </SplitView.Content>

            <SplitView.Pane>
                <Grid Padding="16"
                      Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                      BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                      BorderThickness="1" CornerRadius="12" RowDefinitions="Auto,Auto,*,Auto">

                    <!--  Header  -->
                    <Grid ColumnDefinitions="*,Auto">
                        <TextBlock FontSize="18" FontWeight="SemiBold" Text="{x:Bind ViewModel.SelectedDevice.DisplayName, Mode=OneWay}" />
                    </Grid>

                    <Border Grid.Row="1" Height="1" Margin="0,12,0,12" Background="{ThemeResource CardStrokeColorDefaultBrush}" />

                    <!--  Content  -->
                    <Grid Grid.Row="2" Margin="0,0,0,12">
                        <panes:DeviceSettingsPaneView DataContext="{x:Bind ViewModel.CurrentSettingsPane, Mode=OneWay}" Visibility="{x:Bind ViewModel.PaneMode, Mode=OneWay, Converter={StaticResource PaneModeToSettingsVisibilityConverter}}" />
                        <panes:DeviceInspectPaneView ViewModel="{x:Bind ViewModel.SelectedDevice, Mode=OneWay}" Visibility="{x:Bind ViewModel.PaneMode, Mode=OneWay, Converter={StaticResource PaneModeToInspectVisibilityConverter}}" />
                    </Grid>

                    <!--  Footer  -->
                    <Grid Grid.Row="3" VerticalAlignment="Bottom" ColumnDefinitions="*,Auto">
                        <Button Grid.Column="1" Command="{x:Bind ViewModel.ApplySettingsCommand}" Content="Apply &amp; Save" Style="{ThemeResource AccentButtonStyle}" Visibility="{x:Bind ViewModel.PaneMode, Mode=OneWay, Converter={StaticResource PaneModeToSettingsVisibilityConverter}}" />
                    </Grid>
                </Grid>
            </SplitView.Pane>
        </SplitView>
    </Grid>
</Page>
