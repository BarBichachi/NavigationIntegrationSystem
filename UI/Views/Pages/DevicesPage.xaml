<?xml version="1.0" encoding="utf-8" ?>
<Page x:Class="NavigationIntegrationSystem.UI.Views.Pages.DevicesPage" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:local="using:NavigationIntegrationSystem.UI.Views.Pages"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:panes="using:NavigationIntegrationSystem.UI.Views.Panes" xmlns:vm="using:NavigationIntegrationSystem.UI.ViewModels.Devices" x:Name="RootPage" mc:Ignorable="d">

    <Grid Padding="16" RowDefinitions="Auto,*">
        <Grid Margin="0,0,0,12" ColumnDefinitions="*,Auto">
            <TextBlock FontSize="24" Text="Devices" />
            <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                <Button Command="{x:Bind ViewModel.SaveDevicesConfigCommand}" Content="Save" />
            </StackPanel>
        </Grid>

        <SplitView Grid.Row="1" DisplayMode="Overlay" IsPaneOpen="{x:Bind ViewModel.IsPaneOpen, Mode=TwoWay}" OpenPaneLength="520" PanePlacement="Right" PaneClosing="OnPaneClosing">
            <SplitView.Content>
                <ListView ItemsSource="{x:Bind ViewModel.Devices, Mode=OneWay}" SelectionMode="None">
                    <ListView.ItemTemplate>
                        <DataTemplate x:DataType="vm:DeviceCardViewModel">
                            <Border Margin="0,0,0,10" Padding="12" BorderThickness="1" CornerRadius="10">
                                <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto, Auto">
                                    <StackPanel Spacing="4">
                                        <TextBlock FontSize="18" Text="{x:Bind DisplayName}" />
                                        <TextBlock Opacity="0.7" Text="{x:Bind Type}" />
                                    </StackPanel>

                                    <StackPanel Grid.Column="1" HorizontalAlignment="Right" Spacing="6">
                                        <TextBlock HorizontalAlignment="Right" Text="{x:Bind Status}" />
                                    </StackPanel>

                                    <StackPanel Grid.Row="1" Grid.ColumnSpan="2" Margin="0,10,0,0" Orientation="Horizontal" Spacing="10">
                                        <Button Command="{x:Bind ToggleConnectCommand}">
                                            <TextBlock Text="{x:Bind IsConnected, Converter={StaticResource BoolToConnectTextConverter}}" />
                                        </Button>

                                        <Button Command="{x:Bind OpenSettingsCommand}" Content="Settings" />
                                        <Button Command="{x:Bind OpenInspectCommand}" Content="Inspect" />
                                    </StackPanel>

                                    <StackPanel Grid.Row="2" Grid.ColumnSpan="2" Margin="0,8,0,0" VerticalAlignment="Center" Orientation="Horizontal"
                                                Spacing="8"
                                                Visibility="{x:Bind HasUnsavedSettings, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
                                        <FontIcon Margin="0,1,0,0" Glyph="&#xE7BA;" />
                                        <TextBlock Foreground="{ThemeResource SystemFillColorCautionBrush}" Text="Settings were changed but not saved" />
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </SplitView.Content>

            <SplitView.Pane>
                <Grid Padding="12" Background="{ThemeResource AcrylicInAppFillColorDefaultBrush}" RowDefinitions="Auto,*,Auto">

                    <!--  Header  -->
                    <Grid ColumnDefinitions="*,Auto">
                        <TextBlock FontSize="18" Text="{x:Bind ViewModel.SelectedDevice.DisplayName, Mode=OneWay}" />
                    </Grid>

                    <!--  Content  -->
                    <Grid Grid.Row="1" Margin="0,12,0,12">
                        <panes:DeviceSettingsPaneView DataContext="{x:Bind ViewModel.CurrentSettingsPane, Mode=OneWay}" Visibility="{x:Bind ViewModel.PaneMode, Mode=OneWay, Converter={StaticResource PaneModeToSettingsVisibilityConverter}}" />
                        <panes:DeviceInspectPaneView ViewModel="{x:Bind ViewModel.SelectedDevice, Mode=OneWay}" Visibility="{x:Bind ViewModel.PaneMode, Mode=OneWay, Converter={StaticResource PaneModeToInspectVisibilityConverter}}" />
                    </Grid>

                    <!--  Footer  -->
                    <Grid Grid.Row="2" VerticalAlignment="Bottom" ColumnDefinitions="*,Auto">
                        <Button Grid.Column="1" Command="{x:Bind ViewModel.ApplySettingsCommand}" Content="Apply &amp; Save" Style="{ThemeResource AccentButtonStyle}" Visibility="{x:Bind ViewModel.PaneMode, Mode=OneWay, Converter={StaticResource PaneModeToSettingsVisibilityConverter}}" />
                    </Grid>
                </Grid>
            </SplitView.Pane>
        </SplitView>
    </Grid>
</Page>
