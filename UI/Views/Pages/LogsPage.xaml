<?xml version="1.0" encoding="utf-8" ?>
<Page x:Class="NavigationIntegrationSystem.UI.Views.Pages.LogsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:logging="using:NavigationIntegrationSystem.Infrastructure.Logging"
      mc:Ignorable="d">

    <Grid KeyboardAcceleratorPlacementMode="Hidden" Padding="16" RowDefinitions="Auto,Auto,*,Auto" RowSpacing="12">
        <!-- Keyboard Accelerators -->
        <Grid.KeyboardAccelerators>
            <KeyboardAccelerator Key="C" Modifiers="Control" Invoked="OnCopyAcceleratorInvoked" />
            <KeyboardAccelerator Key="A" Modifiers="Control" Invoked="OnSelectAllAcceleratorInvoked" />
            <KeyboardAccelerator Key="Delete" Invoked="OnDeleteAcceleratorInvoked" />
            <KeyboardAccelerator Key="Escape" Invoked="OnEscapeAcceleratorInvoked" />
        </Grid.KeyboardAccelerators>

        <!-- Header -->
        <TextBlock FontSize="24" FontWeight="SemiBold" Text="Logs" />

        <!-- Filters + Actions (same row) -->
        <Grid Grid.Row="1" ColumnDefinitions="360,80,*,120,120,120" ColumnSpacing="10" VerticalAlignment="Center">
            <!-- Left: filters -->
            <TextBox Grid.Column="0" Width="360" PlaceholderText="Search..." Text="{x:Bind ViewModel.SearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            <ComboBox Grid.Column="1" Width="80" SelectedValue="{x:Bind ViewModel.SelectedLevel, Mode=TwoWay}" SelectedValuePath="Content">
                <ComboBoxItem Content="All" />
                <ComboBoxItem Content="DEBUG" />
                <ComboBoxItem Content="INFO" />
                <ComboBoxItem Content="WARN" />
                <ComboBoxItem Content="ERROR" />
            </ComboBox>

            <!-- Column 3 is the flexible spacer (*) -->

            <!-- Right: actions -->
            <Button Grid.Column="3" Width="120" Content="{x:Bind ViewModel.CopyButtonText, Mode=OneWay}" Command="{x:Bind ViewModel.CopyCommand, Mode=OneWay}" CommandParameter="{x:Bind LogsList.SelectedItems, Mode=OneWay}" />
            <Button Grid.Column="4" Width="120" Content="{x:Bind ViewModel.ClearButtonText, Mode=OneWay}" Command="{x:Bind ViewModel.ClearCommand, Mode=OneWay}" CommandParameter="{x:Bind LogsList.SelectedItems, Mode=OneWay}" />
            <Button Grid.Column="5" Width="120" Content="{x:Bind ViewModel.SelectAllButtonText, Mode=OneWay}" Command="{x:Bind ViewModel.ToggleSelectAllCommand, Mode=OneWay}" CommandParameter="{x:Bind LogsList, Mode=OneWay}" />
        </Grid>

        <!-- Log list container -->
        <Border Grid.Row="2" CornerRadius="12" BorderThickness="1" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}">
            <ListView x:Name="LogsList" ItemsSource="{x:Bind ViewModel.FilteredEntries, Mode=OneWay}" Padding="8" SelectionMode="Multiple" SelectionChanged="OnLogsSelectionChanged">
                <!-- Log entry template -->
                <ListView.ItemTemplate>
                    <DataTemplate x:DataType="logging:LogEntry">
                        <Grid Padding="8" ColumnDefinitions="Auto,Auto,*" ColumnSpacing="16" VerticalAlignment="Center">
                            <TextBlock Grid.Column="0" FontFamily="Consolas" Opacity="0.75" Text="{x:Bind Timestamp, Mode=OneWay}" VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="1" FontFamily="Consolas" FontWeight="SemiBold" Text="{x:Bind Level}" Foreground="{x:Bind Level, Converter={StaticResource LogLevelToBrushConverter}}" VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="2" Text="{x:Bind Message}" TextWrapping="WrapWholeWords" VerticalAlignment="Center"/>

                            <Rectangle Grid.ColumnSpan="3" Height="1" VerticalAlignment="Bottom" Opacity="0.25" Fill="{ThemeResource CardStrokeColorDefaultBrush}" />
                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </Border>

        <!-- Footer -->
        <Grid Grid.Row="3" ColumnDefinitions="*,Auto" VerticalAlignment="Center">
            <TextBlock Opacity="0.7" Text="{x:Bind ViewModel.LogFolderPath, Mode=OneWay}" VerticalAlignment="Center" />
            <HyperlinkButton Grid.Column="1" Content="Open logs folder" Command="{x:Bind ViewModel.OpenLogFolderCommand}" />
        </Grid>
    </Grid>
</Page>
